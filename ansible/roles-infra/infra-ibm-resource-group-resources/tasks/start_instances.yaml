---
- name: List all IBM Cloud instances
  ibm.cloudcollection.instance_info:
    region: "{{ ibmcloud_region }}"
  register: r_ibmcloud_instances

- name: Start all running instances
  ibm.cloudcollection.instance:
    id: "{{ item['id'] }}"
    region: "{{ ibmcloud_region }}"
    state: running
  with_items: "{{ r_ibmcloud_instances.instances }}"
  when: item['status'] == 'stopped'
