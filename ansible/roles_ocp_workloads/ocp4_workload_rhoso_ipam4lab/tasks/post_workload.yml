---
# Implement your Post Workload deployment tasks here

- name: Print IP allocation information
  agnosticd_user_info:
    msg:
      - ""
      - "RHOSO External IP Allocation Details:"
      - "======================================="
      - ""
      - "Allocation Name: {{ _ipam_allocation_name }}"
      - "Cluster: {{ _ipam_cluster_name }}"
      - "Network Subnet: {{ _ipam_subnet }}"
      - "Network CIDR: {{ _ipam_network }}"
      - ""
      - "Allocated IP Addresses:"
      - "  EXTERNAL_IP_WORKER_1={{ _ipam_worker_ip_1 }}"
      - "  EXTERNAL_IP_WORKER_2={{ _ipam_worker_ip_2 }}"
      - "  EXTERNAL_IP_WORKER_3={{ _ipam_worker_ip_3 }}"
      - "  EXTERNAL_IP_BASTION={{ _ipam_bastion_ip }}"
      - "  PUBLIC_NET_START={{ _ipam_public_net_start }}"
      - "  PUBLIC_NET_END={{ _ipam_public_net_end }}"
      - "  CONVERSION_HOST_IP={{ _ipam_conversion_host_ip }}"
      - ""
      - "Environment Variables (copy and paste):"
      - "export EXTERNAL_IP_WORKER_1={{ _ipam_worker_ip_1 }}"
      - "export EXTERNAL_IP_WORKER_2={{ _ipam_worker_ip_2 }}"
      - "export EXTERNAL_IP_WORKER_3={{ _ipam_worker_ip_3 }}"
      - "export EXTERNAL_IP_BASTION={{ _ipam_bastion_ip }}"
      - "export PUBLIC_NET_START={{ _ipam_public_net_start }}"
      - "export PUBLIC_NET_END={{ _ipam_public_net_end }}"
      - "export CONVERSION_HOST_IP={{ _ipam_conversion_host_ip }}"
      - ""

- name: Store IP allocation data for other workloads
  when: ocp4_workload_rhoso_ipam4lab_include_raw_response | bool
  agnosticd_user_info:
    data:
      rhoso_cluster_name: "{{ ocp4_workload_rhoso_ipam4lab_cluster_name }}"
      rhoso_ipam_allocation_name: "{{ _ipam_allocation_name }}"
      rhoso_ipam_cluster_name: "{{ _ipam_cluster_name }}"
      rhoso_ipam_subnet: "{{ _ipam_subnet }}"
      rhoso_ipam_network: "{{ _ipam_network }}"
      rhoso_external_ip_worker_1: "{{ _ipam_worker_ip_1 }}"
      rhoso_external_ip_worker_2: "{{ _ipam_worker_ip_2 }}"
      rhoso_external_ip_worker_3: "{{ _ipam_worker_ip_3 }}"
      rhoso_external_ip_bastion: "{{ _ipam_bastion_ip }}"
      rhoso_public_net_start: "{{ _ipam_public_net_start }}"
      rhoso_public_net_end: "{{ _ipam_public_net_end }}"
      rhoso_conversion_host_ip: "{{ _ipam_conversion_host_ip }}"

# Leave this as the last task in the playbook
- name: Post_workload tasks complete
  when: not silent | bool
  ansible.builtin.debug:
    msg: "Post-Workload tasks completed successfully."
